(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{523:function(e,t,a){"use strict";a.r(t);var o=a(10),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("You can export the MySQL database with schema table definitions and data separated. Here is a simple bash shell script that will export an database.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# file: database-export.sh\nDB_NAME=mydb\nDB_SCHEMA_FILE=mydb.sql\nDB_DATA_FILE=mydb-data.sql\nDB_USERNAME=root\nDB_PASSWORD=secret\n\n# export schema only from mysql \necho "`date` Exporting database $DB_NAME schema to $DB_SCHEMA_FILE"\nmysqldump --no-data --routines -u $DB_USERNAME -p$DB_PASSWORD $DB_NAME > $DB_SCHEMA_FILE\n\\\n# export data only from mysql\n\necho "`date` Exporting database $DB_NAME data to $DB_DATA_FILE"\nmysqldump --single-transaction --quick --no-autocommit --no-create-info --extended-insert=false -u $DB_USERNAME -p$DB_PASSWORD $DB_NAME > $DB_DATA_FILE\n\necho "`date` Done."\n')])])]),a("p",[e._v('The schema export with "--routines" will export stored proc as well. When exporitng data you have to be little more careful. The "--single-transaction" will ensure your data is good. The "--no-autocommit" can really speed up your import later on certain OS.')]),e._v(" "),a("p",[e._v("Now to import these files back, you can create an empty database and then run the following.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# file: database-import.sh \n# import schema and data into mysql\necho "`date` Importing Schema $DB_SCHEMA_FILE into $DB_NAME"\nmysql -f -u $DB_USERNAME -p$DB_PASSWORD $DB_NAME < $DB_SCHEMA_FILE\necho "`date` Importing DATA $DB_DATA_FILE into $DB_NAME"\nmysql -f -u $DB_USERNAME -p$DB_PASSWORD $DB_NAME < $DB_DATA_FILE\n\necho "`date` Done."\n')])])]),a("p",[e._v('The import with "-f" option will allow you to continue even if you already have duplicated data in the tables; it will simply ignore and continue.')]),e._v(" "),a("p",[e._v("These two combo commands will allow you to quicly backup and restore a MySQL database.")]),e._v(" "),a("p",[e._v("Enjoy.")]),e._v(" "),a("p",[e._v('PS: I have come to learn that "mysqldump" with procedures will insert an extra line like "DEFINER \'user\'@\'hostname\'", and it may create problem if you use different users to export/import or even run the application! Unfortunately there is no exclude from the "mysqldump" tool. So you have to manually strip that off if that\'s creating a problem for you.')]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('mysqldump --no-data --routines -u $DB_USERNAME -p$DB_PASSWORD $DB_NAME | perl -pi -e \'s/DEFINER="\\w+"@"\\w+" //g\' > $DB_SCHEMA_FILE\n')])])]),a("p",[e._v("You can vote the issue here: "),a("a",{attrs:{href:"http://bugs.mysql.com/bug.php?id=24680",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://bugs.mysql.com/bug.php?id=24680"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=n.exports}}]);