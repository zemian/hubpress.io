<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      How to make an executable WAR file &middot; Zemian's Blog
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/2012/08/14/how-to-make-an-executable-war-file/">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">

  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-135626598-1', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A weblog on software development.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="http://localhost:4000/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://localhost:4000/about/">About</a>
        
      
    
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2020. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Zemian's Blog</a>
            <small>Life in programming world!</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">How to make an executable WAR file</h1>
  <span class="post-date">14 Aug 2012</span>
  <p>If you ever used <a href="http://jenkins-ci.org">Jenkin</a> CI server, you have probably seen their super easy one-line instruction to get started: <code class="language-plaintext highlighter-rouge">java -jar jenkins.war</code>. Now that’s one awesome way to get your users to try out your product!</p>

<p>In this article, I will show you how to make a WAR file self executable just like above. Before I do that, let me tell you a little web app that I made, and then I will show how I converted it into runnable <code class="language-plaintext highlighter-rouge">war</code>.</p>

<h2 id="the-requirement-taking-notes-efficiently">The Requirement: Taking Notes Efficiently</h2>

<p>I tend take a lot of notes when I do my work. Instead of using the crapy Windows Notepad.exe, I would setup my cygwin <code class="language-plaintext highlighter-rouge">.bash_profile</code> like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function e() { /cygdrive/C/apps/notepad++.exe $(cygpath -w "$@") ; }
function n() { F="$HOME/notes/$(date "+%Y%m%d-%H%M%S").markdown"; touch $F; e $F; }
</code></pre></div></div>

<p>I happen to have <a href="http://notepad-plus-plus.org">Notepad++</a> installed, but you can use just about any text editor you like. With that setup, then anywhere in my terminal I can simply type <code class="language-plaintext highlighter-rouge">n</code> to have a GUI editor pop open, and I will have my note file ready to record notes. The file name would have a timestamp date, and I like to record them with simple <code class="language-plaintext highlighter-rouge">Markdown</code> syntax for easy viewing later. Since I write them in plain text, it’s easy and fast to search using <code class="language-plaintext highlighter-rouge">grep MYSTUFF ~/notes/*</code>. Once I found it, I can quickly edit it by <code class="language-plaintext highlighter-rouge">e ~/notes/20120814-000000.markdown</code>.</p>

<p>This method of taking notes is fast and portable between my Linux and Windows systems (well, I have to choose a different editor between OS but not big deal). Now since I already recorded my notes in markdown, there is no way I can see the pretty result unless I use an <a href="http://daringfireball.net/projects/markdown/dingus">online converter</a>. So I thought it would be awesome if I can have a web app that let me record these notes, and yet give me a nice quick <code class="language-plaintext highlighter-rouge">Markdown</code> to html view.</p>

<h2 id="introducing-the-webnotepadwar">Introducing the webnotepad.war</h2>

<p>To improve my notes taking, I created little web app called <a href="https://bitbucket.org/saltnlight5/sandbox/downloads">webnotepad.war</a>. It’s really simply one page web app that record notes in Markdown syntax, preview it, and allow you to search it. It also let you edit old notes too. The whole thing is just a Servlet class, and it doesn’t even use JSP.</p>

<p>However, after I have this little web app, it bothers me that I would always need an app server to run it. (I can run <code class="language-plaintext highlighter-rouge">mvn tomcat7:run</code> directly from my source project, but it would require me be online to satisfy initial Maven build.) So here is a perfectly example use case that would be super nice to make this war file self executable. In fact I have succeeded in this little experiement. You can download it and try it out yourself with <code class="language-plaintext highlighter-rouge">java -jar webnotepad.war</code>, and then browse <code class="language-plaintext highlighter-rouge">http://localhost:8080</code>. If you get port conflict, try <code class="language-plaintext highlighter-rouge">--httpPort=8081</code>.</p>

<p>Of course you continue to deploy <code class="language-plaintext highlighter-rouge">webnotepad.war</code> into any app server too.</p>

<h2 id="making-war-file-executable">Making war file executable</h2>

<p>Before you want to make war executable, you want to build and package your normal web application first. The trick to make the war file runnable is that you want additionally add a Main-Class in the <code class="language-plaintext highlighter-rouge">META-INF/MANIFEST.MF</code> in the war file. And from this we need to load and run an embedded Servlet server with the self war file deployed. I noticed Jenkins uses one called <a href="winstone.sourceforge.net">Winstone</a> container server. I was amazed to find that this server only has 300K in size! It support full Servlet 2.5 spec! It can optionally support JSP with Jasper which will cost you up to 3MB in size. That’s still a very small price to pay compare to any Servlet container out there!</p>

<p>Making a Main-Class <a href="https://bitbucket.org/saltnlight5/sandbox/src/4e80e4b4114e/webnotepad/src/main/winstone/WinstoneMain.java">WinstoneMain.java</a> is not hard. However making Maven to package everything is pretty tricky. Now my <code class="language-plaintext highlighter-rouge">webnotepad.war</code> doesn’t need Jasper, but if you do, you specially want these jars outside of <code class="language-plaintext highlighter-rouge">WEB-INF/lib</code> because you don’t want your normal app server to load these! Else you will get very odd errors.</p>

<p>In my example I added into <code class="language-plaintext highlighter-rouge">WEB-INF/lib-winstone</code>, and then the <code class="language-plaintext highlighter-rouge">WinstoneMain</code> would extract these and then load the <code class="language-plaintext highlighter-rouge">winstone.Launcher</code> using a custom class loader. Also, we need to use some Winstone options to start a web server properly. I use this <a href="https://bitbucket.org/saltnlight5/sandbox/src/4e80e4b4114e/webnotepad/pom.xml">webnotepad/pom.xml</a> to package it all up the war file. You can easily use my example because I have create them under a separate <code class="language-plaintext highlighter-rouge">profile</code> and you just need add to your web module/pom.xml. In my project demo you would run <code class="language-plaintext highlighter-rouge">mvn package -Pdist</code> to generate the executable war file.</p>

<p>NOTE: I noticed Winstone project didn’t show much activity since last release since 2008. But I was happy to find that there is a fork project on <a href="http://code.google.com/p/winstone/">GoogleCode Winstone</a> that shows activities. I didn’t use this for my demo, but it looks promising.</p>

</div>


<div class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/09/20/world-of-php/">
            The World of PHP Development
            <small>20 Sep 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/09/19/multiple-jquery/">
            How to Load Multiple jQuery
            <small>19 Sep 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/08/15/switched-to-vuepress/">
            Switched Blogging to VuePress
            <small>15 Aug 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
